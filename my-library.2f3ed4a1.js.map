{"mappings":"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","sources":["src/my-library.js","src/js/btnWatchedQueue.js","src/js/renderCardsMyLibrary.js"],"sourcesContent":["import ApiServiceLibrary from './js/API';\nimport { onQueueBtn, onWatchedBtn } from './js/btnWatchedQueue';\nimport { onSubmitScroll } from './js/onSubmit';\nimport trailer from './js/film-trailer';\nimport showModal from './js/film-modal';\nimport { switcher} from './js/switcher';\nimport { spinner, spinnerRemove } from './js/notifications';\nimport { onOpenTeamModal } from './js/team-modal';\n\nexport const refs = {\n  topButton: document.querySelector('.btn_top'),\n  body: document.querySelector('body'),\n  cardHolderLibrary: document.querySelector('.card-holder'),\n  footerLink: document.querySelector('.footer__link'),\n  stickyHeaderMyLibrary: document.querySelector(\n    '.js-my-library-header__sticky'\n  ),\n  watchedBtn: document.querySelector('.js-watched'),\n  queuedBtn: document.querySelector('.js-queue'),\n  // buttons for collapsed header\n  watchedBtnSticky: document.querySelector('.js-watched__sticky'),\n  queuedBtnSticky: document.querySelector('.js-queue__sticky'),\n\n  movieModal: document.querySelector('.js-movie-modal'),\n  pagination: document.querySelector('.pagination__container'),\n};\n\nconst stickyMyLibrary = (window.onscroll = function showHeaderMyLibrary() {\n  if (window.pageYOffset > 200) {\n    refs.stickyHeaderMyLibrary.classList.add('my-library-header__sticky');\n  } else {\n    refs.stickyHeaderMyLibrary.remove('my-library-header__sticky')\n  }\n});\n\nconst apiService = new ApiServiceLibrary();\n\nrefs.topButton.addEventListener('click', onSubmitScroll);\nrefs.cardHolderLibrary.addEventListener('click', onCardClick);\nrefs.watchedBtn.addEventListener('click', onWatched);\nrefs.queuedBtn.addEventListener('click', onQueued);\nrefs.movieModal.addEventListener('click', onModalClick);\n// collapsed header\nrefs.watchedBtnSticky.addEventListener('click', onWatched);\nrefs.queuedBtnSticky.addEventListener('click', onQueued);\n// regular header\nrefs.pagination.addEventListener('click', onPagination);\nrefs.footerLink.addEventListener('click', onOpenTeamModal);\n\n// initial download\nonWatchedBtn();\n\nfunction onWatched(evt) {\n  console.log(evt.target);\n  if (evt.target.classList.contains('my-library-header__button--current')) return;\n  // for collapsed header\n  refs.watchedBtn.classList.add('my-library-header__button--current');\n  refs.queuedBtn.classList.remove('my-library-header__button--current');\n  // for regular header\n  refs.watchedBtnSticky.classList.add('my-library-header__button--current');\n  refs.queuedBtnSticky.classList.remove('my-library-header__button--current');\n\n  refs.cardHolderLibrary.innerHTML = '';\n  refs.pagination.innerHTML = '';\n  onSubmitScroll();\n  onWatchedBtn(1);\n};\n\nfunction onQueued(evt) {\n  if (evt.target.classList.contains('my-library-header__button--current')) return;\n  //для обычного хедера\n  refs.queuedBtn.classList.add('my-library-header__button--current');\n  refs.watchedBtn.classList.remove('my-library-header__button--current');\n  //для свернутого хедера\n  refs.queuedBtnSticky.classList.add('my-library-header__button--current');\n  refs.watchedBtnSticky.classList.remove('my-library-header__button--current');\n\n  refs.cardHolderLibrary.innerHTML = '';\n  refs.pagination.innerHTML = '';\n  onSubmitScroll();\n  onQueueBtn(1);\n};\n\nfunction onCardClick(evt) {\n  if (evt.target === evt.currentTarget) return;\n\n  if (evt.target.classList.contains('film__trailer-btn')) {\n    return trailer.showTrailer(evt.target.closest('li').id);\n  };\n\n  apiService.movieId = evt.target.closest('li').id;\n  spinner();\n  apiService.fetchById().then(data => {\n    showModal(data.data);\n    spinnerRemove();\n  });\n};\n\n// reloading the library page after deleting a movie\nfunction onModalClick(evt) {\n  const currentPagination = document.querySelector('.pagination__item--current');\n\n  if (evt.target.classList.contains('add-watched') || refs.watchedBtn.classList.contains('my-library-header__button--current')) {\n    const cards = refs.cardHolderLibrary.children.length;\n    refs.cardHolderLibrary.innerHTML = '';\n    onWatchedBtn(Number(currentPagination && cards === 1 ? currentPagination.id - 1 : 0));\n  };\n\n  if (evt.target.classList.contains('add-queue') || refs.queuedBtn.classList.contains('my-library-header__button--current')) {\n    const cards = refs.cardHolderLibrary.children.length;\n    refs.cardHolderLibrary.innerHTML = '';\n    onQueueBtn(Number(currentPagination && cards === 1 ? currentPagination.id - 1 : 0));\n  };\n\n};\n\n// Pagination tracking\nfunction onPagination(evt) {\n  if (evt.target === evt.currentTarget || evt.target.nodeName === 'UL') return;\n\n  let id = null;\n\n  if (evt.target.nodeName === 'svg' || evt.target.nodeName === 'BUTTON' || evt.target.nodeName === 'path') {\n\n    // by left/right button\n    if (evt.target.closest('button').classList.contains('pagination__left-btn') && evt.target.closest('button').classList.contains('on')) {\n      id = Number(currentPagination.id) - 1;\n    } else if (evt.target.closest('button').classList.contains('pagination__right-btn') && evt.target.closest('button').classList.contains('on')) {\n      id = Number(currentPagination.id) + 1;\n    } else return;\n\n  } else {\n\n    // by quantity in the list\n    if (!isNaN(evt.target.closest('li').id)) {\n      id = Number(evt.target.closest('li').id);\n    } else if (evt.target.closest('li').id === '+') {\n      id = Number(currentPagination.id) + 3;\n    } else if (evt.target.closest('li').id === '-') {\n      id = Number(currentPagination.id) - 3;\n    } else return;\n  };\n\n  if (refs.watchedBtn.classList.contains('my-library-header__button--current')) {\n    onSubmitScroll();\n    onWatchedBtn(id);\n  } else {\n    onSubmitScroll();\n    onQueueBtn(id);\n  };\n}","import { spinner, spinnerRemove } from './notifications';\nimport renderCards from './renderCardsMyLibrary';\nimport { getPagination } from './pagination';\n\nconst WATCHED = 'movies-watched';\nconst QUEUE = 'movies-queue';\n\n// Blank page stubs\nconst img = document.querySelector('.empty__page');\nconst text = document.querySelector('.empty__page-text');\nlet currentPage = 1;\nconst libPageSize = 18;\n\nfunction onWatchedBtn(page = 0) {\n  if (page) { currentPage = page };\n\n  img.classList.add('is-hidden');\n  text.classList.add('is-hidden');\n\n  spinner();\n  const obj = JSON.parse(localStorage.getItem(WATCHED));\n  if (obj?.length) {\n    calcLibSize(obj)\n  } else {\n    img.classList.remove('is-hidden');\n    text.classList.remove('is-hidden');\n    spinnerRemove();\n  }\n};\n\nfunction onQueueBtn(page = 0) {\n  if (page) { currentPage = page };\n\n  img.classList.add('is-hidden');\n  text.classList.add('is-hidden');\n\n  spinner();\n  const obj = JSON.parse(localStorage.getItem(QUEUE));\n  if (obj?.length) {\n    calcLibSize(obj)\n  } else {\n    img.classList.remove('is-hidden');\n    text.classList.remove('is-hidden');\n    spinnerRemove();\n  }\n};\n\nfunction calcLibSize(arr) {\n  let lastPage = null;\n\n  if (arr.length <= libPageSize) {\n    renderCards(arr);\n    spinnerRemove();\n  };\n\n  // определение последней страницы\n  if (arr.length % libPageSize) {\n    lastPage = Math.floor(arr.length / libPageSize) + 1;\n  } else {\n    lastPage = arr.length / libPageSize;\n  };\n\n  // рендер соответсвующей страницы\n  if (currentPage === lastPage) {\n    renderCards(arr.slice(currentPage * libPageSize - libPageSize, arr.length));\n    spinnerRemove();\n  } else {\n    renderCards(arr.slice(currentPage * libPageSize - libPageSize, currentPage * libPageSize));\n    spinnerRemove();\n  };\n\n  getPagination(currentPage, lastPage, true)\n};\n\nexport { onWatchedBtn, onQueueBtn };","import { refs } from '../my-library';\nimport { getMarkupImgPoster, getShortName, getGenresByID, getYear } from './renderCards';\n\nfunction renderCards(obj) {\n  refs.cardHolderLibrary.innerHTML = obj.map(({ id, poster_path, name, title, release_date, genres, original_language }) => {\n    return `\n    <li class=\"film__item\" id=\"${id}\">\n      <a class=\"film__item__link\">${getMarkupImgPoster(original_language, poster_path, name, title)}\n        <h2>${getShortName(title || name)}</h2>\n        <p> ${getGenresByID(genres)} | ${getYear(release_date)}</p>\n        <button class=\"film__trailer-btn\" type=\"button\">Trailer \n          <span class=\"film__trailer-btn\">&#9654;</span>\n        </button>\n      </a>\n    </li>`;\n  }).join('');\n};\n\nexport default renderCards;"],"names":["$dNYR7","parcelRequire","$aYvV9","$07b0d4a19403df81$export$2e2bcd8739ae039","obj","$865c390aa2d1ad34$export$21666b427502ea6d","cardHolderLibrary","innerHTML","map","param","id","poster_path","name","title","release_date","genres","original_language","concat","$5rOqX","getMarkupImgPoster","getShortName","getGenresByID","getYear","join","$1da9f0d39b27fa95$var$WATCHED","$1da9f0d39b27fa95$var$QUEUE","$1da9f0d39b27fa95$var$img","document","querySelector","$1da9f0d39b27fa95$var$text","$1da9f0d39b27fa95$var$currentPage","$1da9f0d39b27fa95$var$libPageSize","$1da9f0d39b27fa95$export$f7660da9a1a3fc30","page","arguments","length","classList","add","spinner","JSON","parse","localStorage","getItem","$1da9f0d39b27fa95$var$calcLibSize","remove","spinnerRemove","$1da9f0d39b27fa95$export$47a757308b99947b","arr","lastPage","Math","floor","slice","$jcFG7","getPagination","topButton","body","footerLink","stickyHeaderMyLibrary","watchedBtn","queuedBtn","watchedBtnSticky","queuedBtnSticky","movieModal","pagination","$865c390aa2d1ad34$var$apiService","window","onscroll","pageYOffset","default","$865c390aa2d1ad34$var$onWatched","evt","console","log","target","contains","$dWD7p","onSubmitScroll","$865c390aa2d1ad34$var$onQueued","addEventListener","currentTarget","$3ozO0","showTrailer","closest","movieId","fetchById","then","data","$1Gwk9","currentPagination","cards","children","Number","cards1","nodeName","isNaN","$ghnK3","onOpenTeamModal"],"version":3,"file":"my-library.2f3ed4a1.js.map"}