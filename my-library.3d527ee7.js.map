{"mappings":"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","sources":["src/my-library.js","src/js/btnWatchedQueue.js","src/js/renderCardsMyLibrary.js"],"sourcesContent":["import ApiServiceLibrary from './js/API';\nimport { onQueueBtn, onWatchedBtn } from './js/btnWatchedQueue';\nimport { onSubmitScroll } from './js/onSubmit';\nimport { showModal } from './js/film-modal';\nimport trailer from './js/film-trailer';\nimport { switcher} from './js/switcher';\nimport { spinner, spinnerRemove } from './js/notifications';\nimport { onOpenTeamModal } from './js/team-modal';\n\nexport const refs = {\n  topButton: document.querySelector('.btn_top'),\n  body: document.querySelector('body'),\n  cardHolderLibrary: document.querySelector('.card-holder'),\n  footerLink: document.querySelector('.footer__link'),\n  stickyHeaderMyLibrary: document.querySelector(\n    '.js-my-library-header__sticky'\n  ),\n  watchedBtn: document.querySelector('.js-watched'),\n  queuedBtn: document.querySelector('.js-queue'),\n  //кнопки для свернутого хедера\n  watchedBtnSticky: document.querySelector('.js-watched__sticky'),\n  queuedBtnSticky: document.querySelector('.js-queue__sticky'),\n\n  movieModal: document.querySelector('.js-movie-modal'),\n  pagination: document.querySelector('.pagination__container'),\n};\n\nconst stickyHeaderMyLibrary = (window.onscroll = function showHeaderMyLibrary() {\n  if (window.pageYOffset > 200) {\n    refsLibrary.stickyHeaderMyLibrary.classList.add('my-library-header__sticky');\n  } else {\n    refsLibrary.stickyHeaderMyLibrary.remove('my-library-header__sticky')\n  }\n});\n\nconst apiService = new ApiServiceLibrary();\n\nrefs.topButton.addEventListener('click', onSubmitScroll);\nrefs.cardHolderLibrary.addEventListener('click', onCardClick);\nrefs.watchedBtn.addEventListener('click', onWatched);\nrefs.queuedBtn.addEventListener('click', onQueued);\nrefs.movieModal.addEventListener('click', onModalClick);\n//для свернутого хедера\nrefs.watchedBtnSticky.addEventListener('click', onWatched);\nrefs.queuedBtnSticky.addEventListener('click', onQueued);\n\nrefs.pagination.addEventListener('click', onPagination);\nrefs.footerLink.addEventListener('click', onOpenTeamModal);\n\n// Початкове завантаження\nonWatched();\n\nfunction onWatched(evt) {\n  console.log(evt.target);\n  if (evt.target.classList.contains('my-library-header__button--current')) return;\n  //для обычного хедера\n  refs.watchedBtn.classList.add('my-library-header__button--current');\n  refs.queuedBtn.classList.remove('my-library-header__button--current');\n  //для свернутого хедера\n  refs.watchedBtnSticky.classList.add('my-library-header__button--current');\n  refs.queuedBtnSticky.classList.remove('my-library-header__button--current');\n\n  refs.cardHolderLibrary.innerHTML = '';\n  refs.pagination.innerHTML = '';\n  onSubmitScroll();\n  onWatchedBtn(1);\n};\n\nfunction onQueued(evt) {\n  if (evt.target.classList.contains('my-library-header__button--current')) return;\n  //для обычного хедера\n  refs.queuedBtn.classList.add('my-library-header__button--current');\n  refs.watchedBtn.classList.remove('my-library-header__button--current');\n  //для свернутого хедера\n  refs.queuedBtnSticky.classList.add('my-library-header__button--current');\n  refs.watchedBtnSticky.classList.remove('my-library-header__button--current');\n\n  refs.cardHolderLibrary.innerHTML = '';\n  refs.pagination.innerHTML = '';\n  onSubmitScroll();\n  onQueueBtn(1);\n};\n\nfunction onCardClick(evt) {\n  if (evt.target === evt.currentTarget) return;\n\n  if (evt.target.classList.contains('film__trailer-btn')) {\n    return trailer.showTrailer(evt.target.closest('li').id);\n  };\n\n  apiService.movieId = evt.target.closest('li').id;\n  spinner();\n  apiService.fetchById().then(data => {\n    showModal(data.data);\n    spinnerRemove();\n  });\n};\n\n// Перезавантаження сторінки бібліотеки після видалення фільму\nfunction onModalClick(evt) {\n  const currentPagination = document.querySelector('.pagination__item--current');\n\n  if (evt.target.classList.contains('add-watched') || refs.watchedBtn.classList.contains('my-library-header__button--current')) {\n    const cards = refs.cardHolderLibrary.children.length;\n    refs.cardHolderLibrary.innerHTML = '';\n    onWatchedBtn(Number(currentPagination && cards === 1 ? currentPagination.id - 1 : 0));\n  };\n\n  if (evt.target.classList.contains('add-queue') || refs.queuedBtn.classList.contains('my-library-header__button--current')) {\n    const cards = refs.cardHolderLibrary.children.length;\n    refs.cardHolderLibrary.innerHTML = '';\n    onQueueBtn(Number(currentPagination && cards === 1 ? currentPagination.id - 1 : 0));\n  };\n\n};\n\n// Відстежування пагінації\nfunction onPagination(evt) {\n  if (evt.target === evt.currentTarget || evt.target.nodeName === 'UL') return;\n\n  let id = null;\n\n  if (evt.target.nodeName === 'svg' || evt.target.nodeName === 'BUTTON' || evt.target.nodeName === 'path') {\n\n    // по левой/правой кнопке\n    if (evt.target.closest('button').classList.contains('pagination__left-btn') && evt.target.closest('button').classList.contains('on')) {\n      id = Number(currentPagination.id) - 1;\n    } else if (evt.target.closest('button').classList.contains('pagination__right-btn') && evt.target.closest('button').classList.contains('on')) {\n      id = Number(currentPagination.id) + 1;\n    } else return;\n\n  } else {\n\n    // по количеству в списке\n    if (!isNaN(evt.target.closest('li').id)) {\n      id = Number(evt.target.closest('li').id);\n    } else if (evt.target.closest('li').id === '+') {\n      id = Number(currentPagination.id) + 3;\n    } else if (evt.target.closest('li').id === '-') {\n      id = Number(currentPagination.id) - 3;\n    } else return;\n  };\n\n  if (refs.watchedBtn.classList.contains('my-library-header__button--current')) {\n    onSubmitScroll();\n    onWatchedBtn(id);\n  } else {\n    onSubmitScroll();\n    onQueueBtn(id);\n  };\n}\n\n\n\n\n\n\n\n\n","import { spinner, spinnerRemove } from './notifications';\nimport { renderCards } from './renderCardsMyLibrary';\nimport { getPagination } from './pagination';\n\nconst WATCHED = 'movies-watched';\nconst QUEUE = 'movies-queue';\n\n// Заглушки пустой страницы\nconst img = document.querySelector('.empty__page');\nconst text = document.querySelector('.empty__page-text');\nlet currentPage = 1;\nconst libPageSize = 18;\n\nexport function onWatchedBtn(page = 0) {\n  if (page) { currentPage = page };\n\n  img.classList.add('is-hidden');\n  text.classList.add('is-hidden');\n\n  spinner();\n  const obj = JSON.parse(localStorage.getItem(WATCHED));\n  if (obj?.length) {\n    calcLibSize(obj)\n  } else {\n    img.classList.remove('is-hidden');\n    text.classList.remove('is-hidden');\n    spinnerRemove();\n  }\n};\n\nexport function onQueueBtn(page = 0) {\n  if (page) { currentPage = page };\n\n  img.classList.add('is-hidden');\n  text.classList.add('is-hidden');\n\n  spinner();\n  const obj = JSON.parse(localStorage.getItem(QUEUE));\n  if (obj?.length) {\n    calcLibSize(obj)\n  } else {\n    img.classList.remove('is-hidden');\n    text.classList.remove('is-hidden');\n    spinnerRemove();\n  }\n};\n\nfunction calcLibSize(arr) {\n  let lastPage = null;\n\n  if (arr.length <= libPageSize) {\n    renderCards(arr);\n    spinnerRemove();\n  };\n\n  // определение последней страницы\n  if (arr.length % libPageSize) {\n    lastPage = Math.floor(arr.length / libPageSize) + 1;\n  } else {\n    lastPage = arr.length / libPageSize;\n  };\n\n  // рендер соответсвующей страницы\n  if (currentPage === lastPage) {\n    renderCards(arr.slice(currentPage * libPageSize - libPageSize, arr.length));\n    spinnerRemove();\n  } else {\n    renderCards(arr.slice(currentPage * libPageSize - libPageSize, currentPage * libPageSize));\n    spinnerRemove();\n  };\n\n  getPagination(currentPage, lastPage, true)\n};","import { refs } from '../my-library';\nimport { getMarkupImgPoster, getShortName, getGenresByID, getYear } from './renderCards';\n\nexport function renderCards(obj) {\n  refs.cardHolderLibrary.innerHTML = obj.map(({ id, poster_path, name, title, release_date, genres, original_language }) => {\n    return `\n    <li class=\"film__item\" id=\"${id}\">\n      <a class=\"film__item__link\">${getMarkupImgPoster(original_language, poster_path, name, title)}\n        <h2>${getShortName(title || name)}</h2>\n        <p> ${getGenresByID(genres)} | ${getYear(release_date)}</p>\n        <button class=\"film__trailer-btn\" type=\"button\">Trailer \n          <span class=\"film__trailer-btn\">&#9654;</span>\n        </button>\n      </a>\n    </li>`;\n  }).join('');\n};"],"names":["$cTOKP","parcelRequire","$2Dfe2","$9d606634172bec5e$export$e483d52d8d6686e1","obj","$fc8e7c71b3b7ed96$export$21666b427502ea6d","cardHolderLibrary","innerHTML","map","id","poster_path","name","title","release_date","genres","original_language","$iVxrX","getMarkupImgPoster","getShortName","getGenresByID","getYear","join","$6e6d7532a610e7a5$var$img","document","querySelector","$6e6d7532a610e7a5$var$text","$6e6d7532a610e7a5$var$currentPage","$6e6d7532a610e7a5$export$f7660da9a1a3fc30","page","classList","add","spinner","JSON","parse","localStorage","getItem","length","$6e6d7532a610e7a5$var$calcLibSize","remove","spinnerRemove","$6e6d7532a610e7a5$export$47a757308b99947b","arr","lastPage","Math","floor","slice","$2nhTy","getPagination","topButton","body","footerLink","stickyHeaderMyLibrary","watchedBtn","queuedBtn","watchedBtnSticky","queuedBtnSticky","movieModal","pagination","$fc8e7c71b3b7ed96$var$apiService","window","onscroll","pageYOffset","refsLibrary","default","$fc8e7c71b3b7ed96$var$onWatched","evt","console","log","target","contains","$ka9Wh","onSubmitScroll","$fc8e7c71b3b7ed96$var$onQueued","addEventListener","currentTarget","$eAoKO","showTrailer","closest","movieId","fetchById","then","data","$422V3","showModal","currentPagination","cards","children","Number","nodeName","isNaN","$baGT8","onOpenTeamModal"],"version":3,"file":"my-library.3d527ee7.js.map"}